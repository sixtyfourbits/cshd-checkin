(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2666:(e,t,a)=>{Promise.resolve().then(a.bind(a,3792))},3792:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l});var s=a(5155),r=a(2115),n=a(5695);function c(){let e=(0,n.useSearchParams)().get("seat"),[t,a]=(0,r.useState)({grade:"",class_number:"",student_number:"",name:""}),[c,l]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!0),[i,u]=(0,r.useState)("");(0,r.useEffect)(()=>{if(!e)return void d(!1);(async()=>{try{let t=await fetch("/api/seats/".concat(e));if(!t.ok)throw Error("Failed to fetch seat status");let a=await t.json();l(a.is_occupied),a.is_occupied||localStorage.removeItem("seat-".concat(e))}catch(e){u(e instanceof Error?e.message:"An unknown error occurred")}finally{d(!1)}})()},[e]);let m=e=>{let{name:s,value:r}=e.target;a({...t,[s]:r})},h=async a=>{a.preventDefault(),u("");let s=await fetch("/api/check-in",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,seat_id:e})});if(s.ok)l(!0),localStorage.setItem("seat-".concat(e),"occupied"),alert("청송학당 입실 완료!");else{let{error:e}=await s.json();u(e),alert("오류: ".concat(e))}},p=async()=>{u("");let t=await fetch("/api/check-out",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({seat_id:e})});if(t.ok)l(!1),localStorage.removeItem("seat-".concat(e)),a({grade:"",class_number:"",student_number:"",name:""}),alert("퇴실 완료!");else{let{error:e}=await t.json();u(e),alert("오류: ".concat(e))}};return o?(0,s.jsx)("div",{className:"text-center",children:"로딩 중..."}):e?(0,s.jsxs)("div",{className:"max-w-md mx-auto mt-10 p-8 border rounded-lg shadow-lg bg-white",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-center mb-6",children:["좌석 ",e,"번"]}),c?(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-lg mb-4",children:"이용 중인 좌석입니다."}),(0,s.jsx)("button",{onClick:p,className:"w-full bg-red-500 text-white py-2 rounded-lg hover:bg-red-600",children:"퇴실하기"})]}):(0,s.jsxs)("form",{onSubmit:h,children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,s.jsxs)("select",{name:"grade",onChange:m,className:"p-2 border rounded-md",required:!0,children:[(0,s.jsx)("option",{value:"",children:"학년"}),[1,2,3].map(e=>(0,s.jsxs)("option",{value:e,children:[e,"학년"]},e))]}),(0,s.jsxs)("select",{name:"class_number",onChange:m,className:"p-2 border rounded-md",required:!0,children:[(0,s.jsx)("option",{value:"",children:"반"}),[...Array(10)].map((e,t)=>(0,s.jsxs)("option",{value:t+1,children:[t+1,"반"]},t+1))]}),(0,s.jsxs)("select",{name:"student_number",onChange:m,className:"p-2 border rounded-md",required:!0,children:[(0,s.jsx)("option",{value:"",children:"번호"}),[...Array(35)].map((e,t)=>(0,s.jsxs)("option",{value:t+1,children:[t+1,"번"]},t+1))]})]}),(0,s.jsx)("input",{type:"text",name:"name",placeholder:"이름",onChange:m,className:"w-full p-2 border rounded-md mb-4",required:!0}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600",children:"입실하기"})]}),i&&(0,s.jsx)("p",{className:"text-red-500 text-center mt-4",children:i})]}):(0,s.jsx)("div",{className:"text-center text-red-500",children:"잘못된 접근입니다. QR 코드를 통해 접속해주세요."})}function l(){return(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(c,{})})}},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},e=>{e.O(0,[441,964,358],()=>e(e.s=2666)),_N_E=e.O()}]);